made code extra fool proof without degrading performance